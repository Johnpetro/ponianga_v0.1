<body>
    <main>
        <!-- Hero Area Start-->
        <div class="slider-area ">
            <div class="single-slider section-overly slider-height2 d-flex align-items-center" data-background="assets/img/hero/about.jpg">
                <div class="container">
                    <div class="row">
                        <div class="col-xl-12">
                            <div class="hero-cap text-center">
                                <h2>Job Application</h2>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Hero Area End -->

        <!-- Application Form Start -->
        <section class="contact-section">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <h2 class="contact-title">Apply for Position</h2>
                    </div>
                    <div class="col-lg-8">
                        <form class="form-contact contact_form" action="/application-form" method="post" id="applicationForm" novalidate="novalidate" enctype="multipart/form-data">
                            <div class="row">
                                <!-- Personal Information Section -->
                                <div class="col-12">
                                    <h4 class="mb-3">Personal Information</h4>
                                </div>
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <input class="form-control valid" name="firstName" id="firstName" type="text" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter your first name'" placeholder="First Name" required>
                                    </div>
                                </div>
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <input class="form-control valid" name="lastName" id="lastName" type="text" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter your last name'" placeholder="Last Name" required>
                                    </div>
                                </div>
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <input class="form-control valid" name="email" id="email" type="email" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter email address'" placeholder="Email" required>
                                    </div>
                                </div>
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <input class="form-control" name="phone" id="phone" type="text" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter your phone number'" placeholder="Phone Number">
                                    </div>
                                </div>
                                
                                <div class="col-12">
                                    <div class="form-group">
                                        <input class="form-control" name="address" id="address" type="text" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter your address'" placeholder="Address">
                                    </div>
                                </div>

                                <!-- Professional Information Section -->
                                <div class="col-12 mt-4">
                                    <h4 class="mb-3">Professional Information</h4>
                                </div>
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <input class="form-control" name="currentPosition" id="currentPosition" type="text" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter your current position'" placeholder="Current Position">
                                    </div>
                                </div>
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <input class="form-control" name="experience" id="experience" type="text" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Years of experience'" placeholder="Years of Experience">
                                    </div>
                                </div>
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <input class="form-control" name="expectedSalary" id="expectedSalary" type="text" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Expected salary'" placeholder="Expected Salary">
                                    </div>
                                </div>
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <input class="form-control" name="availableFrom" id="availableFrom" type="date" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Available from date'" placeholder="Available From">
                                    </div>
                                </div>

                                <!-- Education Section -->
                                <div class="col-12 mt-4">
                                    <h4 class="mb-3">Education</h4>
                                </div>
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <input class="form-control" name="degree" id="degree" type="text" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter your highest degree'" placeholder="Highest Degree">
                                    </div>
                                </div>
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <input class="form-control" name="university" id="university" type="text" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter your university'" placeholder="University/College">
                                    </div>
                                </div>
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <input class="form-control" name="graduationYear" id="graduationYear" type="text" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Graduation year'" placeholder="Graduation Year">
                                    </div>
                                </div>
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <input class="form-control" name="gpa" id="gpa" type="text" onfocus="this.placeholder = ''" onblur="this.placeholder = 'GPA (optional)'" placeholder="GPA">
                                    </div>
                                </div>

                                <!-- Skills and Cover Letter -->
                                <div class="col-12 mt-4">
                                    <h4 class="mb-3">Skills & Cover Letter</h4>
                                </div>
                                
                                <div class="col-12">
                                    <div class="form-group">
                                        <input class="form-control" name="skills" id="skills" type="text" onfocus="this.placeholder = ''" onblur="this.placeholder = 'List your key skills (comma separated)'" placeholder="Key Skills (comma separated)">
                                    </div>
                                </div>
                                
                                <div class="col-12">
                                    <div class="form-group">
                                        <textarea class="form-control w-100" name="coverLetter" id="coverLetter" cols="30" rows="9" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Write your cover letter here...'" placeholder="Cover Letter"></textarea>
                                    </div>
                                </div>

                                <!-- File Upload Section -->
                                <div class="col-12 mt-4">
                                    <h4 class="mb-3">Documents</h4>
                                </div>
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label for="resume" class="form-label">Upload Resume/CV (Required)</label>
                                        <input class="form-control" name="resume" id="resume" type="file" accept=".pdf,.doc,.docx" required>
                                        <small class="text-muted">Accepted formats: PDF, DOC, DOCX (Max 5MB)</small>
                                    </div>
                                </div>
                                
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label for="portfolio" class="form-label">Portfolio/Additional Documents (Optional)</label>
                                        <input class="form-control" name="portfolio" id="portfolio" type="file" accept=".pdf,.doc,.docx,.zip" multiple>
                                        <small class="text-muted">Optional: Portfolio, certificates, etc.</small>
                                    </div>
                                </div>

                                <!-- Hidden field for job ID if provided -->
                                <% if (typeof jobId !== 'undefined') { %>
                                <input type="hidden" name="jobId" value="<%= jobId %>">
                                <% } %>

                                <!-- Agreement and Submit -->
                                <div class="col-12 mt-4">
                                    <div class="form-group form-check">
                                        <input type="checkbox" class="form-check-input" id="agreement" name="agreement" required>
                                        <label class="form-check-label" for="agreement">
                                            I agree to the <a href="#" target="_blank">Terms and Conditions</a> and <a href="#" target="_blank">Privacy Policy</a>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group mt-3">
                                <button type="submit" class="button button-contactForm boxed-btn">Submit Application</button>
                            </div>
                        </form>
                        
                        <!-- Success/Error Messages -->
                        <div class="mt-4">
                            <div id="successMessage" class="alert alert-success" style="display: none;">
                                <strong>Success!</strong> Your application has been submitted successfully. We'll get back to you soon.
                            </div>
                            <div id="errorMessage" class="alert alert-danger" style="display: none;">
                                <strong>Error!</strong> There was a problem submitting your application. Please try again.
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-3 offset-lg-1">
                        <div class="media contact-info">
                            <span class="contact-info__icon"><i class="ti-home"></i></span>
                            <div class="media-body">
                                <h3>Application Tips</h3>
                                <p>Make sure to:</p>
                                <ul>
                                    <li>Fill out all required fields</li>
                                    <li>Upload an updated resume</li>
                                    <li>Write a compelling cover letter</li>
                                    <li>Double-check your contact information</li>
                                    <li>Review before submitting</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="media contact-info">
                            <span class="contact-info__icon"><i class="ti-tablet"></i></span>
                            <div class="media-body">
                                <h3>Need Help?</h3>
                                <p>If you have any questions about the application process, please contact our HR team.</p>
                                <p><strong>Email:</strong> hr@company.com</p>
                                <p><strong>Phone:</strong> +1 234 567 8900</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- Application Form End -->

    </main>

    <!-- JavaScript for form handling -->
    <script>
        // Show success/error messages based on URL parameters
        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('success') === 'true') {
                document.getElementById('successMessage').style.display = 'block';
            }
            if (urlParams.get('error') === 'true') {
                document.getElementById('errorMessage').style.display = 'block';
            }
        }

        // Form submission with file upload
        document.getElementById('applicationForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            // Validation
            const requiredFields = ['firstName', 'lastName', 'email', 'resume'];
            let isValid = true;

            requiredFields.forEach(field => {
                const input = document.getElementById(field);
                if (field === 'resume') {
                    // Check if file is selected
                    if (!input.files || input.files.length === 0) {
                        input.style.borderColor = 'red';
                        isValid = false;
                    } else {
                        input.style.borderColor = '';
                    }
                } else {
                    // Check if text field has value
                    if (!input.value.trim()) {
                        input.style.borderColor = 'red';
                        isValid = false;
                    } else {
                        input.style.borderColor = '';
                    }
                }
            });

            // Check agreement checkbox
            const agreement = document.getElementById('agreement');
            if (!agreement.checked) {
                alert('Please agree to the Terms and Conditions and Privacy Policy');
                isValid = false;
            }

            // Validate file size (5MB)
            const resumeFile = document.getElementById('resume').files[0];
            if (resumeFile && resumeFile.size > 5 * 1024 * 1024) {
                alert('Resume file is too large. Maximum size is 5MB.');
                isValid = false;
            }

            if (!isValid) {
                alert('Please fill in all required fields');
                return;
            }

            // Create FormData for multipart upload
            const formData = new FormData(this);

            try {
                const response = await fetch('/application-form', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.success) {
                    // Show success message
                    document.getElementById('successMessage').style.display = 'block';
                    document.getElementById('errorMessage').style.display = 'none';
                    
                    // Reset form
                    document.getElementById('applicationForm').reset();
                    
                    // Scroll to success message
                    document.getElementById('successMessage').scrollIntoView({ behavior: 'smooth' });
                    
                    // Reset border colors
                    requiredFields.forEach(field => {
                        const input = document.getElementById(field);
                        input.style.borderColor = '';
                    });
                } else {
                    // Show error message
                    document.getElementById('errorMessage').style.display = 'block';
                    document.getElementById('errorMessage').innerHTML = '<strong>Error!</strong> ' + result.message;
                    document.getElementById('successMessage').style.display = 'none';
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('errorMessage').style.display = 'block';
                document.getElementById('errorMessage').innerHTML = '<strong>Error!</strong> There was a problem submitting your application.';
                document.getElementById('successMessage').style.display = 'none';
            }
        });
    </script>
</body>