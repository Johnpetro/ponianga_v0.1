
    <div class="overflow-y-auto h-[calc(100vh-64px)]">
      <div class="p-6">
        <div class="card table-card gap-y-6">
          <div class="card-header flex items-center justify-between">
            <h5>Job Postings</h5>
            <button id="addJobBtn" class="  px-6 py-8 text-white bg-blue-500 hover:bg-blue-600 rounded transition flex items-center gap-2">
              <i class="fas fa-plus"></i>
              Add Job
            </button>
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="w-full text-sm">
                <thead>
                  <tr class="border-b border-slate-200 dark:border-slate-600">
                    <th class="text-left px-4 py-3 font-semibold text-slate-900 dark:text-white">Job ID</th>
                    <th class="text-left px-4 py-3 font-semibold text-slate-900 dark:text-white">Image</th>
                    <th class="text-left px-4 py-3 font-semibold text-slate-900 dark:text-white">Job Title</th>
                    <th class="text-left px-4 py-3 font-semibold text-slate-900 dark:text-white">Employer</th>
                    <th class="text-left px-4 py-3 font-semibold text-slate-900 dark:text-white">Type</th>
                    <th class="text-left px-4 py-3 font-semibold text-slate-900 dark:text-white">Location</th>
                    <th class="text-left px-4 py-3 font-semibold text-slate-900 dark:text-white">Salary</th>
                    <th class="text-left px-4 py-3 font-semibold text-slate-900 dark:text-white">Skills</th>
                    <th class="text-left px-4 py-3 font-semibold text-slate-900 dark:text-white">Deadline</th>
                    <th class="text-center px-4 py-3 font-semibold text-slate-900 dark:text-white">Applicants</th>
                    <th class="text-left px-4 py-3 font-semibold text-slate-900 dark:text-white">Status</th>
                    <th class="text-center px-4 py-3 font-semibold text-slate-900 dark:text-white">Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <% if (jobs && jobs.length > 0) { %>
                    <% jobs.forEach((job) => { %>
                      <tr class="border-b border-slate-200 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors">
                        <td class="px-4 py-3 text-slate-700 dark:text-slate-300">
                          <span class="font-semibold">#<%= String(job.id).padStart(3, '0') %></span>
                        </td>
                        <td class="px-4 py-3">
                          <div class="w-12 h-12 rounded-lg overflow-hidden bg-slate-100 dark:bg-slate-700 flex items-center justify-center">
                            <% if (job.image && job.image.trim() !== '') { %>
                              <img src="<%= job.image %>" alt="<%= job.jobTitle %>" class="w-full h-full object-cover" />
                            <% } else { %>
                              <i class="fas fa-briefcase text-slate-400 dark:text-slate-500 text-lg"></i>
                            <% } %>
                          </div>
                        </td>
                        <td class="px-4 py-3 text-slate-700 dark:text-slate-300">
                          <h6 class="font-semibold mb-1"><%= job.jobTitle %></h6>
                          <p class="text-xs text-slate-500"><%= job.skills %></p>
                        </td>
                        <td class="px-4 py-3 text-slate-700 dark:text-slate-300">
                          <span><%= job.employer %></span>
                        </td>
                        <td class="px-4 py-3 text-slate-700 dark:text-slate-300">
                          <span class="badge bg-blue-100 text-blue-800 text-xs"><%= job.jobType %></span>
                        </td>
                        <td class="px-4 py-3 text-slate-700 dark:text-slate-300">
                          <span><%= job.location %></span>
                        </td>
                        <td class="px-4 py-3 text-slate-700 dark:text-slate-300">
                          <span class="font-semibold text-green-600 dark:text-green-400"><%= job.salary %></span>
                        </td>
                        <td class="px-4 py-3 text-slate-700 dark:text-slate-300">
                          <span class="text-xs"><%= job.skills %></span>
                        </td>
                        <td class="px-4 py-3 text-slate-700 dark:text-slate-300">
                          <span class="text-xs"><%= new Date(job.deadline).toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' }) %></span>
                        </td>
                        <td class="px-4 py-3 text-center">
                          <a href="/applications/job/<%= job.id %>" class="flex items-center justify-center gap-2 px-3 py-1 bg-blue-50 dark:bg-blue-900 text-blue-600 dark:text-blue-300 rounded hover:bg-blue-100 dark:hover:bg-blue-800 transition font-semibold text-sm">
                            <i class="fas fa-users text-sm"></i>
                            <span><%= job.applicants %></span>
                          </a>
                        </td>
                        <td class="px-4 py-3">
                          <% 
                            let statusColor = 'green';
                            if (job.status === 'Pending') statusColor = 'yellow';
                            if (job.status === 'Closed') statusColor = 'red';
                          %>
                          <span class="badge bg-<%= statusColor %>-100 text-<%= statusColor %>-800 text-xs flex items-center justify-center gap-1 w-fit">
                            <i class="fas fa-circle text-[8px]"></i>
                            <%= job.status %>
                          </span>
                        </td>
                        <td class="px-4 py-3 text-center">
                          <div class="flex items-center justify-center gap-2">
                            <button class="view-job-btn text-green-500 hover:text-green-700 transition" title="View" data-job-id="<%= job.id %>" data-job-title="<%= job.jobTitle %>" data-job-desc="<%= job.description %>" data-job-employer="<%= job.employer %>" data-job-type="<%= job.jobType %>" data-job-location="<%= job.location %>" data-job-skills="<%= job.skills %>" data-job-salary="<%= job.salary %>" data-job-image="<%= job.image || '' %>">
                              <i class="fas fa-eye text-sm"></i>
                            </button>
                            <button class="text-blue-500 hover:text-blue-700 transition edit-job-btn" title="Edit" data-job-id="<%= job.id %>" data-job-title="<%= job.jobTitle %>" data-job-desc="<%= job.description %>" data-job-employer="<%= job.employer %>" data-job-type="<%= job.jobType %>" data-job-location="<%= job.location %>" data-job-skills="<%= job.skills %>" data-job-salary="<%= job.salary %>" data-job-status="<%= job.status %>" data-job-applicants="<%= job.applicants %>" data-job-deadline="<%= job.deadline %>" data-job-image="<%= job.image || '' %>">
                              <i class="fas fa-edit text-sm"></i>
                            </button>
                            <button class="text-red-500 hover:text-red-700 transition delete-job-btn" title="Delete" data-job-id="<%= job.id %>">
                              <i class="fas fa-trash text-sm"></i>
                            </button>
                          </div>
                        </td>
                      </tr>
                    <% }); %>
                  <% } else { %>
                    <tr>
                      <td colspan="12" class="px-4 py-8 text-center text-slate-500 dark:text-slate-400">
                        <i class="fas fa-inbox text-2xl mb-2"></i>
                        <p>No jobs posted yet. Click "Add Job" to create one.</p>
                      </td>
                    </tr>
                  <% } %>
                </tbody>
              </table>
            </div>

            <!-- Pagination Controls -->
            <div class="flex items-center justify-between mt-6 px-4 py-4 border-t border-slate-200 dark:border-slate-600">
              <div class="text-sm text-slate-600 dark:text-slate-400">
                Showing <span class="font-semibold"><%= jobs && jobs.length > 0 ? (currentPage - 1) * jobsPerPage + 1 : 0 %></span> 
                to <span class="font-semibold"><%= Math.min(currentPage * jobsPerPage, totalJobs) %></span> 
                of <span class="font-semibold"><%= totalJobs %></span> jobs
              </div>

              <div class="flex items-center gap-2">
                <% if (currentPage > 1) { %>
                  <a href="/jobs?page=<%= currentPage - 1 %>" class="px-3 py-2 bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 rounded hover:bg-slate-200 dark:hover:bg-slate-600 transition flex items-center gap-2">
                    <i class="fas fa-chevron-left text-sm"></i>
                    Previous
                  </a>
                <% } else { %>
                  <button disabled class="px-3 py-2 bg-slate-100 dark:bg-slate-700 text-slate-400 dark:text-slate-600 rounded cursor-not-allowed opacity-50 flex items-center gap-2">
                    <i class="fas fa-chevron-left text-sm"></i>
                    Previous
                  </button>
                <% } %>

                <div class="flex items-center gap-1">
                  <% for (let i = 1; i <= totalPages; i++) { %>
                    <% if (i === currentPage) { %>
                      <button disabled class="w-8 h-8 flex items-center justify-center bg-blue-500 text-white rounded font-semibold">
                        <%= i %>
                      </button>
                    <% } else { %>
                      <a href="/jobs?page=<%= i %>" class="w-8 h-8 flex items-center justify-center bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 rounded hover:bg-slate-200 dark:hover:bg-slate-600 transition font-semibold">
                        <%= i %>
                      </a>
                    <% } %>
                  <% } %>
                </div>

                <% if (currentPage < totalPages) { %>
                  <a href="/jobs?page=<%= currentPage + 1 %>" class="px-3 py-2 bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 rounded hover:bg-slate-200 dark:hover:bg-slate-600 transition flex items-center gap-2">
                    Next
                    <i class="fas fa-chevron-right text-sm"></i>
                  </a>
                <% } else { %>
                  <button disabled class="px-3 py-2 bg-slate-100 dark:bg-slate-700 text-slate-400 dark:text-slate-600 rounded cursor-not-allowed opacity-50 flex items-center gap-2">
                    Next
                    <i class="fas fa-chevron-right text-sm"></i>
                  </button>
                <% } %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Job Details Modal -->
    <div id="jobModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden-modal flex items-center justify-center p-4" style="display: none;">
      <div class="bg-white dark:bg-slate-800 rounded-lg shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
        <!-- Modal Header -->
        <div class="sticky top-0 flex items-center justify-between p-6 border-b border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800">
          <h3 class="text-xl font-semibold text-slate-900 dark:text-white">Job Details</h3>
          <button class="close-modal text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300 transition">
            <i class="fas fa-times text-xl"></i>
          </button>
        </div>

        <!-- Modal Body -->
        <div class="p-6 space-y-4">
          <div>
            <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">Job Image</label>
            <div id="modalJobImageContainer" class="w-20 h-20 rounded-lg overflow-hidden bg-slate-100 dark:bg-slate-700 flex items-center justify-center mb-4">
              <img id="modalJobImage" src="" alt="" class="w-full h-full object-cover hidden" />
              <i id="modalJobImagePlaceholder" class="fas fa-briefcase text-slate-400 dark:text-slate-500 text-2xl"></i>
            </div>
          </div>

          <div>
            <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">Job Title</label>
            <p id="modalJobTitle" class="text-slate-900 dark:text-white font-medium"></p>
          </div>

          <div>
            <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">Employer</label>
            <p id="modalJobEmployer" class="text-slate-900 dark:text-white font-medium"></p>
          </div>

          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">Job Type</label>
              <p id="modalJobType" class="text-slate-900 dark:text-white font-medium"></p>
            </div>
            <div>
              <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">Location</label>
              <p id="modalJobLocation" class="text-slate-900 dark:text-white font-medium"></p>
            </div>
          </div>

          <div>
            <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">Required Skills</label>
            <p id="modalJobSkills" class="text-slate-900 dark:text-white font-medium"></p>
          </div>

          <div>
            <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">Job Description</label>
            <p id="modalJobDesc" class="text-slate-700 dark:text-slate-300 leading-relaxed"></p>
          </div>
        </div>

        <!-- Modal Footer -->
        <div class="sticky bottom-0 flex items-center justify-end gap-3 p-6 border-t border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800">
          <button class="close-modal px-4 py-2 text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded transition">
            Close
          </button>
        </div>
      </div>
    </div>
  </main>
</div>

<!-- Add Job Modal -->
<div id="addJobModal" style="display: none;" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
  <div class="bg-white dark:bg-slate-800 rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col">
    <!-- Modal Header -->
    <div class="flex items-center justify-between p-6 border-b border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800">
      <h2 class="text-xl font-bold text-slate-900 dark:text-white">Add New Job</h2>
      <button id="closeAddJobBtn" class="text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300">
        <i class="fas fa-times text-xl"></i>
      </button>
    </div>

    <!-- Modal Content (Scrollable) -->
    <form id="addJobForm" class="flex-1 overflow-y-auto p-6 space-y-3" enctype="multipart/form-data">
      <!-- Job Title & Employer (Flex Row) -->
      <div class="flex gap-4">
        <div class="flex-1">
          <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
            <i class="fas fa-briefcase text-blue-500 mr-2"></i>Job Title
          </label>
          <input type="text" name="jobTitle" placeholder="e.g., Senior Frontend" required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500" />
        </div>

        <div class="flex-1">
          <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
            <i class="fas fa-building text-blue-500 mr-2"></i>Employer
          </label>
          <input type="text" name="employer" placeholder="e.g., Tech Corp" required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500" />
        </div>
      </div>

      <!-- Job Type & Location (Flex Row) -->
      <div class="flex gap-4">
        <div class="flex-1">
          <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
            <i class="fas fa-clock text-blue-500 mr-2"></i>Job Type
          </label>
          <select name="jobType" required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
            <option value="">Select Type</option>
            <option value="Full-time">Full-time</option>
            <option value="Part-time">Part-time</option>
            <option value="Remote">Remote</option>
            <option value="Contract">Contract</option>
          </select>
        </div>

        <div class="flex-1">
          <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>Location
          </label>
          <input type="text" name="location" placeholder="e.g., New York, USA" required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500" />
        </div>
      </div>

      <!-- Deadline & Applicants (Flex Row) -->
      <div class="flex gap-4">
        <div class="flex-1">
          <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
            <i class="fas fa-calendar text-blue-500 mr-2"></i>Deadline
          </label>
          <input type="date" name="deadline" required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500" />
        </div>

        <div class="flex-1">
          <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
            <i class="fas fa-users text-blue-500 mr-2"></i>Applicants
          </label>
          <input type="number" name="applicants" placeholder="0" min="0" required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500" />
        </div>

        <div class="flex-1">
          <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
            <i class="fas fa-dollar-sign text-blue-500 mr-2"></i>Salary
          </label>
          <input type="text" name="salary" placeholder="e.g., $100k - $150k" required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500" />
        </div>
      </div>

      <!-- Job Image Upload (Full Width) -->
      <div>
        <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
          <i class="fas fa-image text-blue-500 mr-2"></i>Job Image (Optional)
        </label>
        <input type="file" name="jobImage" accept="image/*" class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500" />
        <p class="text-xs text-slate-500 dark:text-slate-400 mt-1">Upload a company logo or job-related image (JPEG, PNG, GIF - Max 5MB)</p>
      </div>

      <!-- Skills (Full Width) -->
      <div>
        <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
          <i class="fas fa-code text-blue-500 mr-2"></i>Required Skills
        </label>
        <input type="text" name="skills" placeholder="e.g., React, TypeScript, CSS, JavaScript" required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500" />
        <p class="text-xs text-slate-500 dark:text-slate-400 mt-1">Separate skills with commas</p>
      </div>

      <!-- Description (Full Width) -->
      <div>
        <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
          <i class="fas fa-align-left text-blue-500 mr-2"></i>Job Description
        </label>
        <textarea name="description" rows="3" placeholder="Enter the job description..." required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
      </div>
    </form>

    
    <!-- Modal Footer -->
    <div class="flex items-center justify-end gap-3 p-6 border-t border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800">
      <button type="button" id="closeAddJobBtn2" class="px-4 py-2 text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded transition">
        Cancel
      </button>
      <button type="submit" form="addJobForm" class="px-4 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded transition flex items-center gap-2">
        <i class="fas fa-plus"></i>
        Post Job
      </button>
    </div>
  </div>
</div>

<!-- Edit Job Modal -->
<div id="editJobModal" style="display: none;" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
  <div class="bg-white dark:bg-slate-800 rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col">
    <!-- Modal Header -->
    <div class="flex items-center justify-between p-6 border-b border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800">
      <h2 class="text-xl font-bold text-slate-900 dark:text-white">Edit Job</h2>
      <button id="closeEditJobBtn" class="text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300">
        <i class="fas fa-times text-xl"></i>
      </button>
    </div>

    <!-- Modal Content (Scrollable) -->
    <form id="editJobForm" class="flex-1 overflow-y-auto p-6 space-y-3" enctype="multipart/form-data">
      <input type="hidden" id="editJobId" name="jobId" />
      
      <!-- Job Title & Employer (Flex Row) -->
      <div class="flex gap-4">
        <div class="flex-1">
          <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
            <i class="fas fa-briefcase text-blue-500 mr-2"></i>Job Title
          </label>
          <input type="text" id="editJobTitle" name="jobTitle" placeholder="e.g., Senior Frontend" required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500" />
        </div>

        <div class="flex-1">
          <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
            <i class="fas fa-building text-blue-500 mr-2"></i>Employer
          </label>
          <input type="text" id="editEmployer" name="employer" placeholder="e.g., Tech Corp" required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500" />
        </div>
      </div>

      <!-- Job Type & Location (Flex Row) -->
      <div class="flex gap-4">
        <div class="flex-1">
          <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
            <i class="fas fa-clock text-blue-500 mr-2"></i>Job Type
          </label>
          <select id="editJobType" name="jobType" required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
            <option value="">Select Type</option>
            <option value="Full-time">Full-time</option>
            <option value="Part-time">Part-time</option>
            <option value="Remote">Remote</option>
            <option value="Contract">Contract</option>
          </select>
        </div>

        <div class="flex-1">
          <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
            <i class="fas fa-map-marker-alt text-blue-500 mr-2"></i>Location
          </label>
          <input type="text" id="editLocation" name="location" placeholder="e.g., New York, USA" required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500" />
        </div>
      </div>

      <!-- Deadline & Applicants & Salary (Flex Row) -->
      <div class="flex gap-4">
        <div class="flex-1">
          <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
            <i class="fas fa-calendar text-blue-500 mr-2"></i>Deadline
          </label>
          <input type="date" id="editDeadline" name="deadline" required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500" />
        </div>

        <div class="flex-1">
          <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
            <i class="fas fa-users text-blue-500 mr-2"></i>Applicants
          </label>
          <input type="number" id="editApplicants" name="applicants" placeholder="0" min="0" required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500" />
        </div>

        <div class="flex-1">
          <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
            <i class="fas fa-dollar-sign text-blue-500 mr-2"></i>Salary
          </label>
          <input type="text" id="editSalary" name="salary" placeholder="e.g., $100k - $150k" required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500" />
        </div>
      </div>

      <!-- Job Image Upload (Full Width) -->
      <div>
        <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
          <i class="fas fa-image text-blue-500 mr-2"></i>Job Image (Optional)
        </label>
        <div id="currentEditImageContainer" class="mb-3">
          <div class="flex items-center gap-3">
            <div id="currentEditImagePreview" class="w-12 h-12 rounded-lg overflow-hidden bg-slate-100 dark:bg-slate-700 flex items-center justify-center">
              <img id="currentEditImage" src="" alt="" class="w-full h-full object-cover hidden" />
              <i id="currentEditImagePlaceholder" class="fas fa-briefcase text-slate-400 dark:text-slate-500 text-lg"></i>
            </div>
            <div>
              <p id="currentEditImageText" class="text-sm text-slate-600 dark:text-slate-400">No image uploaded</p>
              <p class="text-xs text-slate-500 dark:text-slate-400">Current job image</p>
            </div>
          </div>
        </div>
        <input type="file" id="editJobImage" name="jobImage" accept="image/*" class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500" />
        <p class="text-xs text-slate-500 dark:text-slate-400 mt-1">Upload a new image to replace current one (JPEG, PNG, GIF - Max 5MB)</p>
      </div>

      <!-- Skills (Full Width) -->
      <div>
        <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
          <i class="fas fa-code text-blue-500 mr-2"></i>Required Skills
        </label>
        <input type="text" id="editSkills" name="skills" placeholder="e.g., React, TypeScript, CSS, JavaScript" required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500" />
        <p class="text-xs text-slate-500 dark:text-slate-400 mt-1">Separate skills with commas</p>
      </div>

      <!-- Description (Full Width) -->
      <div>
        <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
          <i class="fas fa-align-left text-blue-500 mr-2"></i>Job Description
        </label>
        <textarea id="editDescription" name="description" rows="3" placeholder="Enter the job description..." required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
      </div>

      <!-- Status (Full Width) -->
      <div>
        <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2">
          <i class="fas fa-flag text-blue-500 mr-2"></i>Status
        </label>
        <select id="editStatus" name="status" required class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
          <option value="Active">Active</option>
          <option value="Pending">Pending</option>
          <option value="Closed">Closed</option>
        </select>
      </div>
    </form>

    <!-- Modal Footer -->
    <div class="flex items-center justify-end gap-3 p-6 border-t border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800">
      <button type="button" id="closeEditJobBtn2" class="px-4 py-2 text-slate-700 dark:text-slate-300 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded transition">
        Cancel
      </button>
      <button type="submit" form="editJobForm" class="px-4 py-2 text-orange-400 bg-blue-500 hover:bg-green-600 rounded transition flex items-center gap-2">
        <i class="fas fa-save"></i>
        Save Changes
      </button>
    </div>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="deleteModal" style="display: none;" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
  <div class="bg-white dark:bg-slate-800 rounded-lg shadow-2xl w-full max-w-sm">
    <!-- Modal Header -->
    <div class="flex items-center justify-between p-6 border-b border-slate-200 dark:border-slate-700">
      <h2 class="text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2">
        <i class="fas fa-exclamation-triangle text-red-500"></i>
        Delete Job
      </h2>
    </div>

    <!-- Modal Body -->
    <div class="p-6">
      <p class="text-slate-700 dark:text-slate-300 mb-2">
        Are you sure you want to delete this job?
      </p>
      <p id="deleteJobTitle" class="text-sm font-semibold text-slate-600 dark:text-slate-400 bg-slate-100 dark:bg-slate-700 p-3 rounded">
        <!-- Job title will be inserted here -->
      </p>
      <p class="text-xs text-slate-500 dark:text-slate-400 mt-3">
        <i class="fas fa-info-circle mr-1"></i>
        This action cannot be undone.
      </p>
    </div>

    <!-- Modal Footer -->
    <div class="flex items-center justify-end gap-3 p-6 border-t border-slate-200 dark:border-slate-700">
      <button id="cancelDeleteBtn" class="px-4 py-2  dark:text-slate-300  dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 rounded transition">
        Cancel
      </button>
      <button id="confirmDeleteBtn" class="px-4 py-2 text-black bg-blue-500 hover:bg-red-600 rounded transition flex items-center gap-2">
        <i class="fas fa-trash"></i>
        Delete Job
      </button>
    </div>
  </div>
</div>

<!-- Sidebar Toggle Script -->
<script src="/js/sidebar-toggle.js"></script>

<!-- Job Modal Script -->
<script>
  // Get modal elements
  const jobModal = document.getElementById('jobModal');
  const viewJobButtons = document.querySelectorAll('.view-job-btn');
  const closeModalButtons = document.querySelectorAll('.close-modal');

  // Open modal function
  function openJobModal(data) {
    document.getElementById('modalJobTitle').textContent = data.title;
    document.getElementById('modalJobEmployer').textContent = data.employer;
    document.getElementById('modalJobType').textContent = data.type;
    document.getElementById('modalJobLocation').textContent = data.location;
    document.getElementById('modalJobSkills').textContent = data.skills;
    document.getElementById('modalJobDesc').textContent = data.desc;
    
    // Handle job image
    const modalImage = document.getElementById('modalJobImage');
    const modalImagePlaceholder = document.getElementById('modalJobImagePlaceholder');
    
    if (data.image && data.image.trim() !== '') {
      modalImage.src = data.image;
      modalImage.alt = data.title;
      modalImage.classList.remove('hidden');
      modalImagePlaceholder.classList.add('hidden');
    } else {
      modalImage.classList.add('hidden');
      modalImagePlaceholder.classList.remove('hidden');
    }
    
    jobModal.style.display = 'flex';
  }

  // Close modal function
  function closeJobModal() {
    jobModal.style.display = 'none';
  }

  // Add click event listeners to View buttons
  viewJobButtons.forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      const data = {
        id: btn.dataset.jobId,
        title: btn.dataset.jobTitle,
        employer: btn.dataset.jobEmployer,
        type: btn.dataset.jobType,
        location: btn.dataset.jobLocation,
        skills: btn.dataset.jobSkills,
        desc: btn.dataset.jobDesc,
        image: btn.dataset.jobImage
      };
      openJobModal(data);
    });
  });

  // Add click event listeners to close buttons
  closeModalButtons.forEach(btn => {
    btn.addEventListener('click', closeJobModal);
  });

  // Close modal when clicking outside (backdrop)
  jobModal.addEventListener('click', (e) => {
    if (e.target === jobModal) {
      closeJobModal();
    }
  });

  // Close modal with ESC key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && jobModal.style.display === 'flex') {
      closeJobModal();
    }
  });

  // Add Job Modal
  const addJobBtn = document.getElementById('addJobBtn');
  const addJobModal = document.getElementById('addJobModal');
  const closeAddJobBtn = document.getElementById('closeAddJobBtn');
  const closeAddJobBtn2 = document.getElementById('closeAddJobBtn2');
  const addJobForm = document.getElementById('addJobForm');

  // Open Add Job Modal
  addJobBtn.addEventListener('click', () => {
    addJobModal.style.display = 'flex';
  });

  // Close Add Job Modal (X button)
  closeAddJobBtn.addEventListener('click', () => {
    addJobModal.style.display = 'none';
  });

  // Close Add Job Modal (Cancel button)
  closeAddJobBtn2.addEventListener('click', () => {
    addJobModal.style.display = 'none';
  });

  // Close modal when clicking outside (backdrop)
  addJobModal.addEventListener('click', (e) => {
    if (e.target === addJobModal) {
      addJobModal.style.display = 'none';
    }
  });

  // Close modal with ESC key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && addJobModal.style.display === 'flex') {
      addJobModal.style.display = 'none';
    }
  });

  // Handle Add Job Form Submit
  addJobForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    // Create FormData object to handle file uploads
    const formData = new FormData(addJobForm);

    try {
      const response = await fetch('/jobs', {
        method: 'POST',
        // Don't set Content-Type header for FormData - browser will set it automatically with boundary
        body: formData
      });

      const result = await response.json();

      if (result.success) {
        alert('Job posted successfully!');
        addJobForm.reset();
        addJobModal.style.display = 'none';
        
        // Reload the page to show the new job
        setTimeout(() => {
          location.reload();
        }, 500);
      } else {
        alert('Error: ' + result.message);
      }
    } catch (error) {
      console.error('Error posting job:', error);
      alert('Error posting job. Please try again.');
    }
  });

  // Edit Job Modal Functionality
  const editJobModal = document.getElementById('editJobModal');
  const editJobButtons = document.querySelectorAll('.edit-job-btn');
  const closeEditJobBtn = document.getElementById('closeEditJobBtn');
  const closeEditJobBtn2 = document.getElementById('closeEditJobBtn2');
  const editJobForm = document.getElementById('editJobForm');
  let currentEditingJobId = null;

  // Open Edit Job Modal and populate fields
  editJobButtons.forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      const jobId = btn.dataset.jobId;
      
      // Get data from button attributes
      const jobTitle = btn.dataset.jobTitle;
      const employer = btn.dataset.jobEmployer;
      const jobType = btn.dataset.jobType;
      const location = btn.dataset.jobLocation;
      const salary = btn.dataset.jobSalary;
      const skills = btn.dataset.jobSkills;
      const description = btn.dataset.jobDesc;
      const status = btn.dataset.jobStatus;
      const applicants = btn.dataset.jobApplicants;
      const deadlineString = btn.dataset.jobDeadline;
      const jobImage = btn.dataset.jobImage;

      // Parse deadline to YYYY-MM-DD format
      const dateObj = new Date(deadlineString);
      const deadline = dateObj.toISOString().split('T')[0];

      // Populate form fields
      document.getElementById('editJobId').value = jobId;
      document.getElementById('editJobTitle').value = jobTitle;
      document.getElementById('editEmployer').value = employer;
      document.getElementById('editJobType').value = jobType;
      document.getElementById('editLocation').value = location;
      document.getElementById('editDeadline').value = deadline;
      document.getElementById('editApplicants').value = applicants;
      document.getElementById('editSalary').value = salary;
      document.getElementById('editSkills').value = skills;
      document.getElementById('editDescription').value = description;
      document.getElementById('editStatus').value = status;

      // Handle current image display
      const currentEditImage = document.getElementById('currentEditImage');
      const currentEditImagePlaceholder = document.getElementById('currentEditImagePlaceholder');
      const currentEditImageText = document.getElementById('currentEditImageText');
      
      if (jobImage && jobImage.trim() !== '') {
        currentEditImage.src = jobImage;
        currentEditImage.alt = jobTitle;
        currentEditImage.classList.remove('hidden');
        currentEditImagePlaceholder.classList.add('hidden');
        currentEditImageText.textContent = 'Current job image';
      } else {
        currentEditImage.classList.add('hidden');
        currentEditImagePlaceholder.classList.remove('hidden');
        currentEditImageText.textContent = 'No image uploaded';
      }

      currentEditingJobId = jobId;
      editJobModal.style.display = 'flex';
    });
  });

  // Close Edit Job Modal (X button)
  closeEditJobBtn.addEventListener('click', () => {
    editJobModal.style.display = 'none';
    currentEditingJobId = null;
  });

  // Close Edit Job Modal (Cancel button)
  closeEditJobBtn2.addEventListener('click', () => {
    editJobModal.style.display = 'none';
    currentEditingJobId = null;
  });

  // Close modal when clicking outside (backdrop)
  editJobModal.addEventListener('click', (e) => {
    if (e.target === editJobModal) {
      editJobModal.style.display = 'none';
      currentEditingJobId = null;
    }
  });

  // Close modal with ESC key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && editJobModal.style.display === 'flex') {
      editJobModal.style.display = 'none';
      currentEditingJobId = null;
    }
  });

  // Handle Edit Job Form Submit
  editJobForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    if (!currentEditingJobId) return;

    // Create FormData to handle file uploads
    const formData = new FormData(editJobForm);
    
    // Remove jobId from formData as it's in the URL
    formData.delete('jobId');

    try {
      const response = await fetch(`/jobs/${currentEditingJobId}`, {
        method: 'PATCH',
        // Don't set Content-Type header for FormData - browser will set it automatically with boundary
        body: formData
      });

      const result = await response.json();

      if (result.success) {
        alert('Job updated successfully!');
        editJobForm.reset();
        editJobModal.style.display = 'none';
        currentEditingJobId = null;
        
        // Reload the page to show the updated job
        setTimeout(() => {
          location.reload();
        }, 500);
      } else {
        alert('Error: ' + result.message);
      }
    } catch (error) {
      console.error('Error updating job:', error);
      alert('Error updating job. Please try again.');
    }
  });

  // Delete Job Functionality
  const deleteModal = document.getElementById('deleteModal');
  const deleteJobButtons = document.querySelectorAll('.delete-job-btn');
  const cancelDeleteBtn = document.getElementById('cancelDeleteBtn');
  const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
  const deleteJobTitle = document.getElementById('deleteJobTitle');
  let jobToDeleteId = null;

  // Only proceed if delete modal exists
  if (deleteModal) {
    // Open delete confirmation modal
    deleteJobButtons.forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.preventDefault();
        const jobId = btn.dataset.jobId;
        const jobTitle = btn.closest('tr').querySelector('h6').textContent;
        
        jobToDeleteId = jobId;
        deleteJobTitle.textContent = jobTitle;
        deleteModal.style.display = 'flex';
      });
    });

    // Cancel delete
    cancelDeleteBtn.addEventListener('click', () => {
      deleteModal.style.display = 'none';
      jobToDeleteId = null;
    });

    // Close modal when clicking outside (backdrop)
    deleteModal.addEventListener('click', (e) => {
      if (e.target === deleteModal) {
        deleteModal.style.display = 'none';
        jobToDeleteId = null;
      }
    });

    // Close modal with ESC key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && deleteModal.style.display === 'flex') {
        deleteModal.style.display = 'none';
        jobToDeleteId = null;
      }
    });

    // Confirm delete
    confirmDeleteBtn.addEventListener('click', async () => {
      if (!jobToDeleteId) return;

      try {
        const response = await fetch(`/jobs/${jobToDeleteId}`, {
          method: 'DELETE',
          headers: {
            'Content-Type': 'application/json'
          }
        });

        const result = await response.json();

        if (result.success) {
          alert('Job deleted successfully!');
          deleteModal.style.display = 'none';
          jobToDeleteId = null;
          
          // Reload the page to show updated list
          setTimeout(() => {
            location.reload();
          }, 500);
        } else {
          alert('Error: ' + result.message);
        }
      } catch (error) {
        console.error('Error deleting job:', error);
        alert('Error deleting job. Please try again.');
      }
    });
  }
</script>